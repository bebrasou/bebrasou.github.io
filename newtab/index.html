<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./main-themes/green/style.css" />
    <link rel="icon" type="image/png" href="chrome://branding/content/icon32.png">
    <link
      href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap"
      rel="stylesheet"
    />
    <title>Новая вкладка</title>
  </head>

  <body>
    <div class="wrapper">
      <div class="bg"></div>
      <div class="maincard">
        <div class="content">
          <div class="image">
            <img
              id="img"
              src="./main-themes/green/images/gif.gif"
              alt="No image"
            />
          </div>
          <div id="links" class="links">
            <section>
              <h3>daily</h3>
              <ul>
                <li><a href="https://www.youtube.com/">youtube</a></li>
                <li><a href="https://www.twitch.tv/">twitch</a></li>
                <li><a href="https://reyohoho.github.io/reyohoho">reyohoho</a></li>
                <li><a href="https://chatgpt.com/?model=auto">chatgpt</a></li>
              </ul>
            </section>
            <section>
              <h3>education</h3>
              <ul>
                <li><a href="https://nz.ua/schedule/diary">nz.ua</a></li>
                <li><a href="https://classroom.google.com/u/1/h?hl=ru">classroom</a></li>
                <li><a href="https://bebrasou.github.io">schedule</a></li>
                <li><a href="https://mail.google.com/mail/u/1/#inbox">gmail</a></li>
              </ul>
            </section>
            <section>
              <h3>coding</h3>
              <ul>
                <li><a href="https://github.com">github</a></li>
                <li><a href="https://leetcode.com">leetcode</a></li>
                <li><a href="https://mail.proton.me/u/0/inbox">proton</a></li>
                <li><a href="https://platform.censys.io/search?q=web.endpoints.http.headers%3A%20(key%3A%20%22Location%22%20and%20value%3A%20%22account.jetbrains.com%2Ffls-auth%22)%20">censys</a></li>
              </ul>
            </section>
            <section>
              <h3>language</h3>
              <ul>
                <li><a href="https://translate.google.com.ua/?hl=ru&sl=ru&tl=uk">google translate</a></li>
                <li><a href="https://www.deepl.com/ru/translator">deepl</a></li>
                <li><a href="https://slovnyk.ua/1">slovnyk</a></li>
                <li><a href="https://goroh.pp.ua/">goroh</a></li>
              </ul>
            </section>
          </div>
        </div>
        <div class="search">
          <form onsubmit="return search()">
            <label for="search_box" autofocus>> find / </label>
            <input
              type="text"
              placeholder="type here"
              name="search_box"
              id="search_box"
              autocomplete="off"
              autofocus
            />
          </form>
        </div>
      </div>
    </div>
  </body>
  <script>
    const themes = [
      "blue",
      "cherry",
      "violet",
      "green",
      "orange",
      "purple",
      "white",
      "mesh-purple",
      "summer-wave",
      "retro-gradient",
    ];

    // Preload all of the themes css to avoid the FOUC on change
    themes.forEach((theme) => {
      const link = document.createElement("link");
      link.rel = "stylesheet";
      link.href = `./main-themes/${theme}/style.css`;
      link.classList.add(`theme-${theme}`);
      link.disabled = true;
      document.head.appendChild(link);
    });

    function changeCSS(theme) {
      // Disable any themes that aren't the selected one
      themes.forEach((t) => {
        document.querySelector(`.theme-${t}`).disabled = t !== theme;
      });
      changeImgSrc(theme);
      // And save it to localStorage
      localStorage.setItem("selected-theme", theme);
    }

    // Change background image
    function changeImgSrc(theme) {
      let img_bar = document.getElementById("img");
      img_bar.src = `./main-themes/${theme}/images/gif.gif`;
    }

    // Load the last selected theme on load
    let storedTheme = localStorage.getItem("selected-theme");
    if (storedTheme) {
      changeCSS(storedTheme);
    }

    const search_url = "https://www.google.com/search?q=";

    function search() {
      const is_url =
        /^(((http)|(https)):\/\/)?(www\.)?[a-zA-Z0-9]+\.[a-zA-Z]+\/?([a-zA-Z0-9/?=&%-_]+)?$/;
      const is_ip =
        /^(((http)|(https)):\/\/)?([0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}|localhost)(:[0-9]{1,5})?(\/[a-zA-Z0-9/?=&%-_]+)?$/;

      const search_term = document.getElementById("search_box").value;
      const url_match = search_term.match(is_url);
      const ip_match = search_term.match(is_ip);
      if (url_match != null) {
        window.location.href =
          url_match[0].substring(0, 4) == "http"
            ? url_match[0]
            : "https://" + url_match[0];
      } else if (ip_match != null) {
        window.location.href =
          ip_match[0].substring(0, 4) == "http"
            ? ip_match[0]
            : "http://" + ip_match[0];
      } else {
        window.location.href = search_url + encodeURIComponent(search_term);
      }

      return false;
    }
  </script>
</html>
